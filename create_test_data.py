#!/usr/bin/env python3
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ Google Sheets
–í–ù–ò–ú–ê–ù–ò–ï: –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –≤–∞—à–µ–π Google —Ç–∞–±–ª–∏—Ü–µ!
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –∫–æ–ø–∏–∏.
"""

import sys
import os
from datetime import datetime, timedelta
import random

# –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—É—â—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≤ path
sys.path.append(os.path.dirname(os.path.abspath(__file__)))

from services.google_sheets import GoogleSheetsService
from config import LEAD_SOURCES

def create_test_data():
    """–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö"""
    print("üö® –í–ù–ò–ú–ê–ù–ò–ï: –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞—Å—Ç —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –≤–∞—à–µ–π Google —Ç–∞–±–ª–∏—Ü–µ!")
    confirmation = input("–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å? (yes/no): ")
    
    if confirmation.lower() != 'yes':
        print("–û–ø–µ—Ä–∞—Ü–∏—è –æ—Ç–º–µ–Ω–µ–Ω–∞.")
        return
    
    try:
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞ Google Sheets
        sheets_service = GoogleSheetsService()
        
        # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–∞–π—Ç–∞
        print("\nüìù –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –ª–∏–¥–æ–≤ —Å —Å–∞–π—Ç–∞...")
        site_test_data = [
            {
                'Date': '2024-01-15',
                'Name': '–ê–Ω–Ω–∞ –°–º–∏—Ä–Ω–æ–≤–∞',
                '–û—á–∏—â–µ–Ω–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω': '+79161234567',
                'Email': 'anna@example.com',
                'utm_source': 'google',
                'utm_medium': 'cpc',
                'utm_campaign': 'promo_winter',
                'utm_content': 'ad_text_1',
                'utm_term': '—Å–∞–ª–æ–Ω –∫—Ä–∞—Å–æ—Ç—ã',
                'ga_client_id': 'GA1.1.123456789.1234567890',
                'ym_client_id': 'YM.1234567890123456789',
                'Form name': '–§–æ—Ä–º–∞ –∑–∞–ø–∏—Å–∏',
                'button_text': '–ó–∞–ø–∏—Å–∞—Ç—å—Å—è'
            },
            {
                'Date': '2024-01-16',
                'Name': '–ï–ª–µ–Ω–∞ –ü–µ—Ç—Ä–æ–≤–∞',
                '–û—á–∏—â–µ–Ω–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω': '+79167654321',
                'Email': 'elena@example.com',
                'utm_source': 'yandex',
                'utm_medium': 'cpc',
                'utm_campaign': 'beauty_services',
                'utm_content': 'ad_text_2',
                'utm_term': '–º–∞–Ω–∏–∫—é—Ä',
                'ga_client_id': 'GA1.1.987654321.9876543210',
                'ym_client_id': 'YM.9876543210987654321',
                'Form name': '–ë—ã—Å—Ç—Ä–∞—è –∑–∞–ø–∏—Å—å',
                'button_text': '–ó–∞–∫–∞–∑–∞—Ç—å'
            }
        ]
        
        # –î–æ–±–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ –ª–∏—Å—Ç —Å–∞–π—Ç–∞
        site_sheet = sheets_service.spreadsheet.worksheet(LEAD_SOURCES['site']['sheet_name'])
        site_sheet.clear()  # –û—á–∏—â–∞–µ–º –ª–∏—Å—Ç
        
        # –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏
        headers = list(LEAD_SOURCES['site']['columns'].values())
        site_sheet.append_row(headers)
        
        # –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        for data in site_test_data:
            row = [data.get(header, '') for header in headers]
            site_sheet.append_row(row)
        
        print(f"‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ {len(site_test_data)} –ª–∏–¥–æ–≤ —Å —Å–∞–π—Ç–∞")
        
        # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–æ—Ü—Å–µ—Ç–µ–π
        print("\nüì± –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –ª–∏–¥–æ–≤ –∏–∑ —Å–æ—Ü—Å–µ—Ç–µ–π...")
        social_test_data = [
            {
                '–î–∞—Ç–∞ –ó–∞—è–≤–∫–∏': '2024-01-17',
                '–ò–º—è –ì–æ—Å—Ç—è': '–ú–∞—Ä–∏—è –ö—É–∑–Ω–µ—Ü–æ–≤–∞',
                '–¢–µ–ª–µ—Ñ–æ–Ω': '+79169876543',
                'Email': 'maria@example.com',
                'UTM Source (–ò—Å—Ç–æ—á–Ω–∏–∫)': 'instagram',
                'UTM Medium (–ö–∞–Ω–∞–ª)': 'social',
                'UTM Campaign (–ö–∞–º–ø–∞–Ω–∏—è)': 'stories_promo',
                'UTM Content (–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ)': 'story_1',
                'UTM Term (–ö–ª—é—á/–î–∞—Ç–∞)': '–∏–Ω—Å—Ç–∞–≥—Ä–∞–º',
                'ga_id': '',
                'ym_id': ''
            },
            {
                '–î–∞—Ç–∞ –ó–∞—è–≤–∫–∏': '2024-01-18',
                '–ò–º—è –ì–æ—Å—Ç—è': '–û–ª—å–≥–∞ –í–æ–ª–∫–æ–≤–∞',
                '–¢–µ–ª–µ—Ñ–æ–Ω': '+79163456789',
                'Email': '',
                'UTM Source (–ò—Å—Ç–æ—á–Ω–∏–∫)': 'vk',
                'UTM Medium (–ö–∞–Ω–∞–ª)': 'social',
                'UTM Campaign (–ö–∞–º–ø–∞–Ω–∏—è)': 'vk_group',
                'UTM Content (–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ)': 'post_1',
                'UTM Term (–ö–ª—é—á/–î–∞—Ç–∞)': '–≤–∫–æ–Ω—Ç–∞–∫—Ç–µ',
                'ga_id': '',
                'ym_id': ''
            }
        ]
        
        # –î–æ–±–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ –ª–∏—Å—Ç —Å–æ—Ü—Å–µ—Ç–µ–π
        social_sheet = sheets_service.spreadsheet.worksheet(LEAD_SOURCES['social']['sheet_name'])
        social_sheet.clear()  # –û—á–∏—â–∞–µ–º –ª–∏—Å—Ç
        
        # –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏
        headers = list(LEAD_SOURCES['social']['columns'].values())
        social_sheet.append_row(headers)
        
        # –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        for data in social_test_data:
            row = [data.get(header, '') for header in headers]
            social_sheet.append_row(row)
        
        print(f"‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ {len(social_test_data)} –ª–∏–¥–æ–≤ –∏–∑ —Å–æ—Ü—Å–µ—Ç–µ–π")
        
        # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤
        print("\nüë• –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤...")
        guests_test_data = [
            {
                '–ò–º—è': '–ê–Ω–Ω–∞ –°–º–∏—Ä–Ω–æ–≤–∞',
                '–¢–µ–ª–µ—Ñ–æ–Ω': '+79161234567',
                'Email': 'anna@example.com',
                '–ö–æ–ª-–≤–æ –≤–∏–∑–∏—Ç–æ–≤': 3,
                '–û–±—â–∞—è —Å—É–º–º–∞': 8500,
                '–ü–µ—Ä–≤—ã–π –≤–∏–∑–∏—Ç': '2024-01-20',
                '–ü–æ—Å–ª–µ–¥–Ω–∏–π –≤–∏–∑–∏—Ç': '2024-01-25',
                '–°—á—ë—Ç 1-–≥–æ –≤–∏–∑–∏—Ç–∞': 3000,
                '–°—á—ë—Ç 2-–≥–æ –≤–∏–∑–∏—Ç–∞': 2500,
                '–°—á—ë—Ç 3-–≥–æ –≤–∏–∑–∏—Ç–∞': 3000,
                '–°—á—ë—Ç 4-–≥–æ –≤–∏–∑–∏—Ç–∞': '',
                '–°—á—ë—Ç 5-–≥–æ –≤–∏–∑–∏—Ç–∞': '',
                '–°—á—ë—Ç 6-–≥–æ –≤–∏–∑–∏—Ç–∞': '',
                '–°—á—ë—Ç 7-–≥–æ –≤–∏–∑–∏—Ç–∞': '',
                '–°—á—ë—Ç 8-–≥–æ –≤–∏–∑–∏—Ç–∞': '',
                '–°—á—ë—Ç 9-–≥–æ –≤–∏–∑–∏—Ç–∞': '',
                '–°—á—ë—Ç 10-–≥–æ –≤–∏–∑–∏—Ç–∞': ''
            },
            {
                '–ò–º—è': '–ú–∞—Ä–∏—è –ö—É–∑–Ω–µ—Ü–æ–≤–∞',
                '–¢–µ–ª–µ—Ñ–æ–Ω': '+79169876543',
                'Email': 'maria@example.com',
                '–ö–æ–ª-–≤–æ –≤–∏–∑–∏—Ç–æ–≤': 1,
                '–û–±—â–∞—è —Å—É–º–º–∞': 2000,
                '–ü–µ—Ä–≤—ã–π –≤–∏–∑–∏—Ç': '2024-01-22',
                '–ü–æ—Å–ª–µ–¥–Ω–∏–π –≤–∏–∑–∏—Ç': '2024-01-22',
                '–°—á—ë—Ç 1-–≥–æ –≤–∏–∑–∏—Ç–∞': 2000,
                '–°—á—ë—Ç 2-–≥–æ –≤–∏–∑–∏—Ç–∞': '',
                '–°—á—ë—Ç 3-–≥–æ –≤–∏–∑–∏—Ç–∞': '',
                '–°—á—ë—Ç 4-–≥–æ –≤–∏–∑–∏—Ç–∞': '',
                '–°—á—ë—Ç 5-–≥–æ –≤–∏–∑–∏—Ç–∞': '',
                '–°—á—ë—Ç 6-–≥–æ –≤–∏–∑–∏—Ç–∞': '',
                '–°—á—ë—Ç 7-–≥–æ –≤–∏–∑–∏—Ç–∞': '',
                '–°—á—ë—Ç 8-–≥–æ –≤–∏–∑–∏—Ç–∞': '',
                '–°—á—ë—Ç 9-–≥–æ –≤–∏–∑–∏—Ç–∞': '',
                '–°—á—ë—Ç 10-–≥–æ –≤–∏–∑–∏—Ç–∞': ''
            }
        ]
        
        # –î–æ–±–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ –ª–∏—Å—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤
        guests_sheet = sheets_service.spreadsheet.worksheet(LEAD_SOURCES['guests']['sheet_name'])
        guests_sheet.clear()  # –û—á–∏—â–∞–µ–º –ª–∏—Å—Ç
        
        # –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏
        headers = list(LEAD_SOURCES['guests']['columns'].values())
        guests_sheet.append_row(headers)
        
        # –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        for data in guests_test_data:
            row = [data.get(header, '') for header in headers]
            guests_sheet.append_row(row)
        
        print(f"‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ {len(guests_test_data)} –∫–ª–∏–µ–Ω—Ç–æ–≤")
        
        print("\nüéâ –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω—ã!")
        print("\n–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ:")
        print("1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞: python bot.py")
        print("2. –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É /merge_leads –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö")
        print("3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É /dashboard –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–∞—à–±–æ—Ä–¥–∞")
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö: {e}")
        print("\n–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:")
        print("1. –ù–∞—Å—Ç—Ä–æ–π–∫—É Google Sheets API")
        print("2. –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ç–∞–±–ª–∏—Ü–µ")
        print("3. –ù–∞–ª–∏—á–∏–µ –ª–∏—Å—Ç–æ–≤ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏")

if __name__ == "__main__":
    create_test_data()
