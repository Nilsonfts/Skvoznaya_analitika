# üöÄ –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –∫–∞—Ä–∞–æ–∫–µ-—Ä—é–º–æ—á–Ω–æ–π "–ï–≤–≥–µ–Ω–∏—á –°–ü–ë" –Ω–∞ Railway

## üìã –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—é

### 1. –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∫–∞—Ä–∞–æ–∫–µ-–±–∞—Ä–∞
- ‚úÖ PostgreSQL –∏ Redis –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- ‚úÖ –ù–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚úÖ Rate limiting –∏ error handling

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Railway

**–ü–ª–∞–≥–∏–Ω—ã –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:**
```json
"plugins": [
  { "id": "postgresql" },
  { "id": "redis" }
]
```

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
```bash
# –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ
BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–æ—Ç_BotFather
ADMIN_IDS=–≤–∞—à_telegram_id

# –°–∏—Å—Ç–µ–º–∞ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç Railway)
USE_POSTGRES=true
DATABASE_URL=postgresql://... (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
REDIS_URL=redis://... (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
METRIKA_COUNTER_ID=101368505
RESTOPLACE_API_KEY=–≤–∞—à_–∫–ª—é—á_restoplace
DEBUG_MODE=false
LOG_LEVEL=INFO
TIMEZONE=Europe/Moscow
DAILY_REPORT_TIME=09:00
```

## üîß –ü–æ—à–∞–≥–æ–≤–æ–µ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
1. –í–æ–π–¥–∏—Ç–µ –≤ [Railway](https://railway.app)
2. –ù–∞–∂–º–∏—Ç–µ "New Project"
3. –í—ã–±–µ—Ä–∏—Ç–µ "Deploy from GitHub repo"
4. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π `Skvoznaya_analitika`

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
1. **–î–æ–±–∞–≤–∏—Ç—å PostgreSQL:**
   - –í –ø—Ä–æ–µ–∫—Ç–µ –Ω–∞–∂–º–∏—Ç–µ "+ New"
   - –í—ã–±–µ—Ä–∏—Ç–µ "Database" ‚Üí "PostgreSQL"
   - Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç `DATABASE_URL`

2. **–î–æ–±–∞–≤–∏—Ç—å Redis:**
   - –ù–∞–∂–º–∏—Ç–µ "+ New" 
   - –í—ã–±–µ—Ä–∏—Ç–µ "Database" ‚Üí "Redis"
   - Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç `REDIS_URL`

### –®–∞–≥ 3: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –∏ –¥–æ–±–∞–≤—å—Ç–µ:

```bash
# Telegram Bot
BOT_TOKEN=123456789:AAAA...
ADMIN_IDS=123456789,987654321
REPORT_CHAT_ID=-100123456789

# –°–∏—Å—Ç–µ–º–∞
USE_POSTGRES=true
DEBUG_MODE=false
LOG_LEVEL=INFO

# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
METRIKA_COUNTER_ID=101368505
METRIKA_OAUTH_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω
RESTOPLACE_API_KEY=–≤–∞—à_–∫–ª—é—á

# –í—Ä–µ–º—è –∏ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è
TIMEZONE=Europe/Moscow
DAILY_REPORT_TIME=09:00
```

### –®–∞–≥ 4: –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
–ü–æ—Å–ª–µ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –ë–î:

1. –û—Ç–∫—Ä–æ–π—Ç–µ Railway CLI –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–µ–±-–∫–æ–Ω—Å–æ–ª—å
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—ã:
```bash
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É
railway shell

# –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
python database/migrate.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã
python test_system.py
```

## üìä –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –Ω–∞ Railway

### üéØ –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞:
- `/report` - –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Ç—á—ë—Ç
- `/channels_chart` - üìä –≥—Ä–∞—Ñ–∏–∫ –∫–∞–Ω–∞–ª–æ–≤
- `/segments_chart` - ü•ß –¥–∏–∞–≥—Ä–∞–º–º–∞ —Å–µ–≥–º–µ–Ω—Ç–æ–≤  
- `/forecast` - üìà –ø—Ä–æ–≥–Ω–æ–∑ –≤—ã—Ä—É—á–∫–∏
- `/compare Instagram –í–ö–æ–Ω—Ç–∞–∫—Ç–µ` - ‚öñÔ∏è —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤
- `/status` - üîß —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã (–∞–¥–º–∏–Ω—ã)

### üìà –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –¥–ª—è –∫–∞—Ä–∞–æ–∫–µ-–±–∞—Ä–∞:
- **–°–µ–∑–æ–Ω–Ω—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã**: –¥–µ–∫–∞–±—Ä—å 1.5x (–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤—ã), –ª–µ—Ç–æ 0.9x
- **–°–µ–≥–º–µ–Ω—Ç—ã –∫–ª–∏–µ–Ω—Ç–æ–≤**: –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤—ã, –¥–Ω–∏ —Ä–æ–∂–¥–µ–Ω–∏—è, —Å–µ–º–µ–π–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è
- **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –≥—Ä–∞—Ñ–∏–∫–∏ –≤ Telegram
- **–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ**: —Å —É—á—ë—Ç–æ–º —Ä–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–π —Å–ø–µ—Ü–∏—Ñ–∏–∫–∏

## üõ†Ô∏è –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

### Health Check
Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
- `/health` endpoint –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫—É–Ω–¥
- –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö (–¥–æ 3 –ø–æ–ø—ã—Ç–æ–∫)

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
railway logs

# –°–ª–µ–¥–∏—Ç—å –∑–∞ –ª–æ–≥–∞–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏  
railway logs --follow
```

### –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **PostgreSQL**: –±—ã—Å—Ç—Ä—ã–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã
- **Redis**: –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ rate limiting
- **RAM**: ~256MB –¥–ª—è –±–∞–∑–æ–≤–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
- **CPU**: burst –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤

## üö® –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

1. **Google Sheets –æ—à–∏–±–∫–∏** ‚úÖ –†–µ—à–µ–Ω–æ
   - –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ PostgreSQL
   - Google Sheets –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ fallback

2. **Rate Limiting –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç** 
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `REDIS_URL` –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
   - Redis –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω –∫–∞–∫ —Å–µ—Ä–≤–∏—Å

3. **–ì—Ä–∞—Ñ–∏–∫–∏ –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É matplotlib/seaborn
   - –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –Ω–∞–ª–∏—á–∏–∏ –ø–∞–º—è—Ç–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏

4. **Telegram –∫–æ–º–∞–Ω–¥—ã –Ω–µ –æ—Ç–≤–µ—á–∞—é—Ç**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `BOT_TOKEN`
   - –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ `ADMIN_IDS`

### –ö–æ–º–∞–Ω–¥—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã
python test_system.py

# –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π
python demo_system.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
python -c "from services.database import get_db_service; import asyncio; asyncio.run(get_db_service())"
```

## üéâ –ì–æ—Ç–æ–≤–æ –∫ –∑–∞–ø—É—Å–∫—É!

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ —Å–∏—Å—Ç–µ–º–∞ "–ö–∞—Ä–∞–æ–∫–µ-–†—é–º–æ—á–Ω–∞—è –ï–≤–≥–µ–Ω–∏—á –°–ü–ë" –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç–∞ –Ω–∞ Railway —Å:

- ‚úÖ PostgreSQL –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
- ‚úÖ Redis –¥–ª—è rate limiting  
- ‚úÖ –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ –≤ Telegram
- ‚úÖ –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å—é
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á—ë—Ç—ã
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ—à–∏–±–æ–∫

**URL –ø—Ä–æ–µ–∫—Ç–∞**: `https://–≤–∞—à-–ø—Ä–æ–µ–∫—Ç.up.railway.app`
**–°—Ç–∞—Ç—É—Å**: üü¢ –ê–∫—Ç–∏–≤–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ

---
*–°–∏—Å—Ç–µ–º–∞ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –∫–∞—Ä–∞–æ–∫–µ-—Ä—é–º–æ—á–Ω–æ–π –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–π —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏*
